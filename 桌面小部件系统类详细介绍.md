# uWidget 类详细介绍文档

## 文档概述

本文档详细介绍了 uWidget 中每个类的设计目的、功能特性、接口定义和使用方法。系统采用分层架构设计，共包含6个主要层次和30+个类。

## 类结构总览

### 架构层次分布

```
uWidget
├── Framework Layer (框架层) - 2个类
├── Core Components (核心组件层) - 3个类  
├── Backend Management (后端管理层) - 4个类
├── Utils (工具层) - 4个类
├── Widget Types (Widget类型层) - 7个类
└── Data Structures (数据结构层) - 3个结构
```

## 详细类介绍

### 📋 目录索引

#### [1. Framework Layer (框架层)](#framework-layer)
- [1.1 WidgetFramework](#widgetframework) - 系统入口点和框架管理
- [1.2 WidgetManager](#widgetmanager) - Widget生命周期管理器

#### [2. Core Components (核心组件层)](#core-components)  
- [2.1 BaseWidget](#basewidget) - Widget抽象基类
- [2.2 WidgetRenderer](#widgetrenderer) - 渲染引擎
- [2.3 InteractionSystem](#interactionsystem) - 交互系统

#### [3. Backend Management (后端管理层)](#backend-management)
- [3.1 ManagementWindow](#managementwindow) - 主管理窗口
- [3.2 ConfigWindow](#configwindow) - 配置窗口
- [3.3 CreateWidgetDialog](#createwidgetdialog) - Widget创建对话框
- [3.4 ThemeSettingsDialog](#themesettingsdialog) - 主题设置对话框

#### [4. Utils (工具层)](#utils)
- [4.1 SystemTray](#systemtray) - 系统托盘管理
- [4.2 Logger](#logger) - 日志记录系统
- [4.3 ThemeManager](#thememanager) - 主题管理器
- [4.4 ThemeResourceManager](#themeresourcemanager) - 主题资源管理

#### [5. Widget Types (Widget类型层)](#widget-types)
- [5.1 ClockWidget](#clockwidget) - 时钟小部件
- [5.2 WeatherWidget](#weatherwidget) - 天气小部件
- [5.3 AIRankingWidget](#airankingwidget) - AI排行榜小部件
- [5.4 SystemPerformanceWidget](#systemperformancewidget) - 系统性能监控
- [5.5 NotesWidget](#noteswidget) - 便签小部件
- [5.6 SimpleNotesWidget](#simplenoteswidget) - 简单便签小部件
- [5.7 CalendarWidget](#calendarwidget) - 日历小部件

#### [6. Data Structures (数据结构层)](#data-structures)
- [6.1 WidgetConfig](#widgetconfig) - Widget配置数据结构
- [6.2 WidgetType](#widgettype) - Widget类型枚举
- [6.3 LogLevel](#loglevel) - 日志级别枚举

---

## Framework Layer

### WidgetFramework

**类别**: 系统核心类  
**继承**: 无基类  
**作用**: 系统入口点，负责整个Widget框架的初始化和管理

#### 🎯 设计目的
WidgetFramework是整个系统的入口点和控制中心，采用单例模式设计，负责系统的启动、关闭以及核心组件的协调工作。

#### 📊 类成员

**私有属性**:
```cpp
QMap<QString, BaseWidget*> widgets;    // Widget实例集合
WidgetConfig config;                   // 框架配置
bool isInitialized;                    // 初始化状态
```

**公有方法**:
```cpp
bool initialize();                     // 初始化框架
void shutdown();                       // 关闭框架
WidgetManager* getWidgetManager();     // 获取Widget管理器
```

#### 🔧 使用示例
```cpp
// 系统启动
WidgetFramework* framework = WidgetFramework::getInstance();
if (framework->initialize()) {
    WidgetManager* manager = framework->getWidgetManager();
    // 开始使用系统
}

// 系统关闭
framework->shutdown();
```

#### ⚠️ 注意事项
- 使用单例模式，全局唯一实例
- 必须在使用任何Widget功能前先调用initialize()
- 程序退出前应调用shutdown()进行资源清理

---

### WidgetManager

**类别**: 管理器类  
**继承**: QObject  
**作用**: Widget的生命周期管理器，负责Widget的创建、销毁、启动和停止

#### 🎯 设计目的
WidgetManager是Widget的生命周期管理器，采用工厂模式创建不同类型的Widget，并提供统一的管理接口。支持Widget的动态创建、配置加载、状态管理等功能。

#### 📊 类成员

**私有属性**:
```cpp
QMap<QString, BaseWidget*> m_widgets;  // Widget实例映射
QString m_configPath;                  // 配置文件路径
```

**公有方法**:
```cpp
bool createWidget(const WidgetConfig& config);    // 创建Widget
bool removeWidget(const QString& id);             // 移除Widget
bool startWidget(const QString& id);              // 启动Widget
bool stopWidget(const QString& id);               // 停止Widget
bool loadConfiguration();                         // 加载配置
bool saveConfiguration();                         // 保存配置
QList<QString> getWidgetIds() const;              // 获取Widget ID列表
BaseWidget* getWidget(const QString& id) const;   // 获取Widget实例
```

**信号 (Signals)**:
```cpp
void widgetCreated(const QString& id);    // Widget创建信号
void widgetRemoved(const QString& id);    // Widget删除信号
void widgetStarted(const QString& id);    // Widget启动信号
void widgetStopped(const QString& id);    // Widget停止信号
```

#### 🔧 使用示例
```cpp
WidgetManager* manager = new WidgetManager();

// 创建时钟Widget
WidgetConfig clockConfig;
clockConfig.type = WidgetType::Clock;
clockConfig.name = "桌面时钟";
clockConfig.position = QPoint(100, 100);

if (manager->createWidget(clockConfig)) {
    manager->startWidget(clockConfig.id);
}

// 监听Widget状态变化
connect(manager, &WidgetManager::widgetCreated, 
        [](const QString& id) {
    qDebug() << "Widget created:" << id;
});
```

---

## Core Components

### BaseWidget

**类别**: 抽象基类  
**继承**: QWidget  
**作用**: 所有Widget的基类，定义Widget的基本接口和行为

#### 🎯 设计目的
BaseWidget是所有Widget的抽象基类，采用模板方法模式定义Widget的基本生命周期和行为接口。提供统一的拖拽、配置、事件处理等基础功能。

#### 📊 类成员

**保护属性**:
```cpp
WidgetConfig m_config;    // Widget配置
bool m_isDragging;        // 拖拽状态
```

**公有方法**:
```cpp
BaseWidget(const WidgetConfig& config, QWidget* parent = nullptr);
virtual ~BaseWidget();

// 纯虚函数 - 子类必须实现
virtual void updateData() = 0;           // 更新数据
virtual void saveConfiguration() = 0;    // 保存配置
virtual void loadConfiguration() = 0;    // 加载配置

// 公有接口
QString getId() const;                   // 获取ID
WidgetType getType() const;             // 获取类型
```

**保护方法**:
```cpp
void mousePressEvent(QMouseEvent* event) override;   // 鼠标按下事件
void mouseMoveEvent(QMouseEvent* event) override;    // 鼠标移动事件
void paintEvent(QPaintEvent* event) override;        // 绘制事件
```

**信号**:
```cpp
void configurationChanged();    // 配置变化信号
void dataUpdated();            // 数据更新信号
```

#### 🔧 使用示例
```cpp
// 自定义Widget实现
class CustomWidget : public BaseWidget {
    Q_OBJECT
    
public:
    CustomWidget(const WidgetConfig& config, QWidget* parent = nullptr)
        : BaseWidget(config, parent) {
        loadConfiguration();
        setupUI();
    }
    
    void updateData() override {
        // 实现数据更新逻辑
        QDateTime current = QDateTime::currentDateTime();
        updateDisplay(current);
        emit dataUpdated();
    }
    
    void saveConfiguration() override {
        // 保存当前配置到文件
        m_config.customConfig["lastUpdate"] = QDateTime::currentDateTime();
        // 保存到配置文件...
    }
    
    void loadConfiguration() override {
        // 从配置文件加载设置
        // 读取配置文件...
    }
    
private:
    void setupUI() {
        // 设置用户界面
    }
    
    void updateDisplay(const QDateTime& time) {
        // 更新显示内容
    }
};
```

---

### WidgetRenderer

**类别**: 渲染引擎  
**继承**: 无基类  
**作用**: 负责Widget的渲染和绘制队列管理

#### 🎯 设计目的
WidgetRenderer负责Widget的渲染工作，采用渲染队列机制提高绘制效率，支持批量渲染和优先级调度。

#### 📊 类成员

**私有属性**:
```cpp
QQueue<BaseWidget*> renderQueue;    // 渲染队列
QMutex queueMutex;                  // 队列互斥锁
bool isRendering;                   // 渲染状态
```

**公有方法**:
```cpp
void render(BaseWidget* widget);        // 渲染单个Widget
void addToQueue(BaseWidget* widget);    // 添加到渲染队列
void processQueue();                    // 处理渲染队列
void clearQueue();                      // 清空队列
```

#### 🔧 使用示例
```cpp
WidgetRenderer* renderer = new WidgetRenderer();

// 渲染单个Widget
BaseWidget* widget = manager->getWidget("clock_001");
renderer->render(widget);

// 批量渲染
for (const QString& id : manager->getWidgetIds()) {
    BaseWidget* w = manager->getWidget(id);
    renderer->addToQueue(w);
}
renderer->processQueue();
```

---

### InteractionSystem

**类别**: 交互系统  
**继承**: 无基类  
**作用**: 处理用户与Widget的交互事件

#### 🎯 设计目的
InteractionSystem负责处理用户输入事件，包括鼠标、键盘事件的分发和处理，支持Widget的拖拽、点击、快捷键等交互功能。

#### 📊 类成员

**私有属性**:
```cpp
BaseWidget* activeWidget;    // 当前活动Widget
QPoint lastMousePos;         // 上次鼠标位置
```

**公有方法**:
```cpp
bool handleMouseEvent(QMouseEvent* event);    // 处理鼠标事件
bool handleKeyEvent(QKeyEvent* event);        // 处理键盘事件
void setActiveWidget(BaseWidget* widget);     // 设置活动Widget
BaseWidget* getActiveWidget() const;          // 获取活动Widget
```

---

## Backend Management

### ManagementWindow

**类别**: 主窗口类  
**继承**: QWidget  
**作用**: 系统主管理界面，提供Widget管理功能

#### 🎯 设计目的
ManagementWindow是系统的主管理界面，提供可视化的Widget管理功能，包括Widget列表显示、创建、配置、删除等操作。

#### 📊 类成员

**私有属性**:
```cpp
WidgetManager* widgetManager;    // Widget管理器引用
QVBoxLayout* ui;                 // 主布局
QListWidget* widgetList;         // Widget列表
QPushButton* createButton;       // 创建按钮
QPushButton* configButton;       // 配置按钮
QPushButton* removeButton;       // 删除按钮
```

**公有方法**:
```cpp
ManagementWindow(QWidget* parent = nullptr);
void refreshWidgetList();                    // 刷新Widget列表
void showCreateDialog();                     // 显示创建对话框
void showConfigDialog(const QString& id);    // 显示配置对话框
```

**私有槽函数**:
```cpp
void onCreateWidget();     // 创建Widget响应
void onRemoveWidget();     // 删除Widget响应
void onConfigWidget();     // 配置Widget响应
```

#### 🔧 使用示例
```cpp
ManagementWindow* window = new ManagementWindow();
window->show();

// 刷新Widget列表
window->refreshWidgetList();

// 监听Widget变化
connect(widgetManager, &WidgetManager::widgetCreated,
        window, &ManagementWindow::refreshWidgetList);
```

---

### ConfigWindow

**类别**: 配置窗口类  
**继承**: QDialog  
**作用**: Widget配置界面，提供参数设置功能

#### 🎯 设计目的
ConfigWindow为各种Widget提供统一的配置界面，支持动态加载不同Widget的配置选项，提供实时预览和验证功能。

#### 📊 类成员

**私有属性**:
```cpp
BaseWidget* currentWidget;              // 当前配置的Widget
QMap<QString, QVariant> settings;       // 配置设置
QFormLayout* configLayout;              // 配置表单布局
```

**公有方法**:
```cpp
ConfigWindow(BaseWidget* widget, QWidget* parent = nullptr);
void applySettings();      // 应用设置
void resetSettings();      // 重置设置
```

**私有方法**:
```cpp
bool validateInput();      // 验证输入
void setupUI();           // 设置界面
```

---

### CreateWidgetDialog

**类别**: 创建对话框类  
**继承**: QDialog  
**作用**: Widget创建向导，指导用户创建新Widget

#### 🎯 设计目的
CreateWidgetDialog提供友好的Widget创建向导，帮助用户选择Widget类型、配置基本参数，并生成相应的WidgetConfig对象。

#### 📊 类成员

**私有属性**:
```cpp
QComboBox* widgetTypeCombo;    // Widget类型选择
QLineEdit* nameEdit;           // 名称输入框
QSpinBox* xPosSpinBox;         // X位置
QSpinBox* yPosSpinBox;         // Y位置
QSpinBox* widthSpinBox;        // 宽度
QSpinBox* heightSpinBox;       // 高度
```

**公有方法**:
```cpp
CreateWidgetDialog(QWidget* parent = nullptr);
WidgetConfig getWidgetConfig() const;    // 获取配置
```

**私有槽函数**:
```cpp
void onTypeChanged();    // 类型变化响应
void onAccept();         // 确认响应
```

---

### ThemeSettingsDialog

**类别**: 主题设置对话框  
**继承**: QDialog  
**作用**: 主题管理界面，提供主题选择和预览功能

#### 🎯 设计目的
ThemeSettingsDialog提供主题管理功能，支持主题预览、切换、导入导出等操作，为用户提供个性化的界面定制体验。

#### 📊 类成员

**私有属性**:
```cpp
ThemeManager* themeManager;    // 主题管理器
QListWidget* themeList;        // 主题列表
QWidget* previewWidget;        // 预览区域
```

**公有方法**:
```cpp
ThemeSettingsDialog(QWidget* parent = nullptr);
void refreshThemeList();                      // 刷新主题列表
void applyTheme(const QString& themeName);    // 应用主题
```

**私有槽函数**:
```cpp
void onThemeSelected();    // 主题选择响应
```

---

## Utils

### SystemTray

**类别**: 系统托盘类  
**继承**: QObject  
**作用**: 系统托盘管理，提供最小化到托盘功能

#### 🎯 设计目的
SystemTray管理系统托盘相关功能，提供托盘图标显示、右键菜单、消息通知等功能，让应用程序可以在后台运行。

#### 📊 类成员

**私有属性**:
```cpp
QSystemTrayIcon* trayIcon;    // 托盘图标
QMenu* trayMenu;              // 托盘菜单
```

**公有方法**:
```cpp
SystemTray(QObject* parent = nullptr);
void show();                                           // 显示托盘图标
void hide();                                          // 隐藏托盘图标
void showMessage(const QString& title, 
                const QString& message);               // 显示消息
```

**私有槽函数**:
```cpp
void onTrayActivated(QSystemTrayIcon::ActivationReason reason);
```

#### 🔧 使用示例
```cpp
SystemTray* tray = new SystemTray();
tray->show();

// 显示通知消息
tray->showMessage("Widget系统", "新的Widget已创建");
```

---

### Logger

**类别**: 日志系统类  
**继承**: 静态类  
**作用**: 全局日志记录系统，提供分级日志功能

#### 🎯 设计目的
Logger提供全局统一的日志记录功能，支持多级别日志、文件输出、格式化等功能，便于系统调试和问题追踪。

#### 📊 类成员

**静态属性**:
```cpp
static QFile* logFile;        // 日志文件
static LogLevel logLevel;     // 日志级别
```

**静态方法**:
```cpp
static void initialize();                      // 初始化日志系统
static void debug(const QString& message);     // 调试日志
static void info(const QString& message);      // 信息日志
static void warning(const QString& message);   // 警告日志
static void error(const QString& message);     // 错误日志
static void critical(const QString& message);  // 严重错误日志
```

**私有方法**:
```cpp
static void writeLog(LogLevel level, const QString& message);
```

#### 🔧 使用示例
```cpp
// 初始化日志系统
Logger::initialize();

// 记录不同级别的日志
Logger::info("系统启动");
Logger::debug("Widget配置加载完成");
Logger::warning("网络连接超时");
Logger::error("配置文件读取失败");
Logger::critical("系统内存不足");
```

---

### ThemeManager

**类别**: 主题管理器  
**继承**: QObject  
**作用**: 主题系统管理，负责主题加载、切换和资源管理

#### 🎯 设计目的
ThemeManager负责整个主题系统的管理，包括主题加载、切换、资源管理等功能，为系统提供个性化的外观定制能力。

#### 📊 类成员

**私有属性**:
```cpp
QString currentTheme;                        // 当前主题
QMap<QString, ThemeData> themes;             // 主题数据映射
ThemeResourceManager* resourceManager;       // 资源管理器
```

**公有方法**:
```cpp
bool loadTheme(const QString& name);         // 加载主题
QString getCurrentTheme() const;             // 获取当前主题
QStringList getAvailableThemes() const;      // 获取可用主题列表
void applyTheme(const QString& name);        // 应用主题
```

**信号**:
```cpp
void themeChanged(const QString& name);      // 主题变化信号
```

#### 🔧 使用示例
```cpp
ThemeManager* themeManager = new ThemeManager();

// 加载并应用主题
if (themeManager->loadTheme("dark")) {
    themeManager->applyTheme("dark");
}

// 监听主题变化
connect(themeManager, &ThemeManager::themeChanged,
        [](const QString& name) {
    qDebug() << "主题已切换到:" << name;
});
```

---

### ThemeResourceManager

**类别**: 主题资源管理器  
**继承**: 无基类  
**作用**: 主题资源的加载、缓存和管理

#### 🎯 设计目的
ThemeResourceManager专门负责主题相关资源的管理，包括样式表、图标、字体等资源的加载、缓存和释放。

#### 📊 类成员

**私有属性**:
```cpp
QMap<QString, QVariant> resources;      // 资源缓存
QMap<QString, QString> stylesheets;     // 样式表缓存
```

**公有方法**:
```cpp
bool loadThemeResources(const QString& themeName);    // 加载主题资源
QString getStylesheet(const QString& widget);         // 获取样式表
QVariant getResource(const QString& key);             // 获取资源
void clearCache();                                    // 清空缓存
```

---

## Widget Types

### ClockWidget

**类别**: 时钟Widget  
**继承**: BaseWidget  
**作用**: 显示时间和日期的Widget

#### 🎯 设计目的
ClockWidget提供时钟显示功能，支持多种时间格式、日期显示、定时更新等功能，是最基础和常用的桌面Widget。

#### 📊 类成员

**私有属性**:
```cpp
QTimer* timer;           // 更新定时器
QLabel* timeLabel;       // 时间标签
QLabel* dateLabel;       // 日期标签
QString format;          // 时间格式
bool showDate;           // 是否显示日期
```

**公有方法**:
```cpp
ClockWidget(const WidgetConfig& config, QWidget* parent = nullptr);
void updateData() override;           // 更新时间数据
void saveConfiguration() override;    // 保存配置
void loadConfiguration() override;    // 加载配置
```

**私有方法**:
```cpp
void updateTime();                    // 更新时间显示
QString formatTime();                 // 格式化时间
```

#### 🔧 使用示例
```cpp
WidgetConfig clockConfig;
clockConfig.type = WidgetType::Clock;
clockConfig.name = "桌面时钟";
clockConfig.customConfig["format"] = "hh:mm:ss";
clockConfig.customConfig["showDate"] = true;

ClockWidget* clock = new ClockWidget(clockConfig);
clock->show();
```

---

### WeatherWidget

**类别**: 天气Widget  
**继承**: BaseWidget  
**作用**: 显示天气信息的Widget

#### 🎯 设计目的
WeatherWidget提供实时天气信息显示，支持多城市、天气图标、温度显示、定时更新等功能，通过网络API获取天气数据。

#### 📊 类成员

**私有属性**:
```cpp
QLabel* weatherLabel;                    // 天气描述标签
QLabel* temperatureLabel;                // 温度标签
QLabel* iconLabel;                       // 天气图标标签
QNetworkAccessManager* networkManager;   // 网络管理器
QString apiKey;                          // API密钥
QString city;                            // 城市名称
```

**公有方法**:
```cpp
WeatherWidget(const WidgetConfig& config, QWidget* parent = nullptr);
void updateData() override;              // 更新天气数据
void saveConfiguration() override;       // 保存配置
void loadConfiguration() override;       // 加载配置
```

**私有方法**:
```cpp
void fetchWeatherData();                 // 获取天气数据
void parseWeatherResponse(const QByteArray& data);  // 解析天气响应
```

#### 🔧 使用示例
```cpp
WidgetConfig weatherConfig;
weatherConfig.type = WidgetType::Weather;
weatherConfig.customConfig["apiKey"] = "your_api_key";
weatherConfig.customConfig["city"] = "北京";

WeatherWidget* weather = new WeatherWidget(weatherConfig);
weather->show();
```

---

### CalendarWidget

**类别**: 日历Widget  
**继承**: BaseWidget  
**作用**: 显示日历和事件管理的Widget

#### 🎯 设计目的
CalendarWidget提供日历显示和简单的事件管理功能，支持日期选择、事件添加、事件提醒等功能。

#### 📊 类成员

**私有属性**:
```cpp
QCalendarWidget* calendar;              // 日历控件
QListWidget* eventList;                 // 事件列表
QMap<QDate, QStringList> events;        // 事件映射
```

**公有方法**:
```cpp
CalendarWidget(const WidgetConfig& config, QWidget* parent = nullptr);
void updateData() override;
void saveConfiguration() override;
void loadConfiguration() override;
```

**私有方法**:
```cpp
void onDateSelected(const QDate& date);              // 日期选择处理
void addEvent(const QDate& date, const QString& event);  // 添加事件
```

---

### NotesWidget

**类别**: 便签Widget  
**继承**: BaseWidget  
**作用**: 文本便签记录Widget

#### 🎯 设计目的
NotesWidget提供富文本便签功能，支持文本编辑、格式设置、自动保存等功能，适合记录待办事项和简单笔记。

#### 📊 类成员

**私有属性**:
```cpp
QTextEdit* textEdit;        // 文本编辑器
QPushButton* saveButton;    // 保存按钮
QString content;            // 便签内容
```

**公有方法**:
```cpp
NotesWidget(const WidgetConfig& config, QWidget* parent = nullptr);
void updateData() override;
void saveConfiguration() override;
void loadConfiguration() override;
```

**私有方法**:
```cpp
void saveNotes();           // 保存便签
void onTextChanged();       // 文本变化处理
```

---

### SimpleNotesWidget

**类别**: 简单便签Widget  
**继承**: BaseWidget  
**作用**: 极简便签显示Widget

#### 🎯 设计目的
SimpleNotesWidget提供极简的便签显示功能，只支持纯文本显示和简单编辑，占用资源更少，适合显示简短提醒信息。

#### 📊 类成员

**私有属性**:
```cpp
QLabel* noteLabel;          // 便签标签
QPushButton* editButton;    // 编辑按钮
bool isEditing;             // 编辑状态
```

**公有方法**:
```cpp
SimpleNotesWidget(const WidgetConfig& config, QWidget* parent = nullptr);
void updateData() override;
void saveConfiguration() override;
void loadConfiguration() override;
```

**私有方法**:
```cpp
void toggleEditMode();      // 切换编辑模式
```

---

### AIRankingWidget

**类别**: AI排行榜Widget  
**继承**: BaseWidget  
**作用**: 显示AI排行榜信息的Widget

#### 🎯 设计目的
AIRankingWidget显示各种AI相关的排行榜信息，如AI模型排名、技术趋势等，通过网络API定时获取最新数据。

#### 📊 类成员

**私有属性**:
```cpp
QListWidget* rankingList;               // 排行榜列表
QTimer* updateTimer;                    // 更新定时器
QNetworkAccessManager* networkManager;  // 网络管理器
```

**公有方法**:
```cpp
AIRankingWidget(const WidgetConfig& config, QWidget* parent = nullptr);
void updateData() override;
void saveConfiguration() override;
void loadConfiguration() override;
```

**私有方法**:
```cpp
void fetchRankingData();        // 获取排行榜数据
void updateRankingDisplay();    // 更新排行榜显示
```

---

### SystemPerformanceWidget

**类别**: 系统性能监控Widget  
**继承**: BaseWidget  
**作用**: 系统性能实时监控Widget

#### 🎯 设计目的
SystemPerformanceWidget实时监控系统性能指标，包括CPU使用率、内存使用率、磁盘使用率等，提供可视化的性能展示。

#### 📊 类成员

**私有属性**:
```cpp
QProgressBar* cpuUsageBar;      // CPU使用率进度条
QProgressBar* memoryUsageBar;   // 内存使用率进度条
QProgressBar* diskUsageBar;     // 磁盘使用率进度条
QTimer* updateTimer;            // 更新定时器
```

**公有方法**:
```cpp
SystemPerformanceWidget(const WidgetConfig& config, QWidget* parent = nullptr);
void updateData() override;
void saveConfiguration() override;
void loadConfiguration() override;
```

**私有方法**:
```cpp
void updateSystemInfo();       // 更新系统信息
double getCpuUsage();          // 获取CPU使用率
double getMemoryUsage();       // 获取内存使用率
```

---

## Data Structures

### WidgetConfig

**类别**: 数据结构  
**作用**: Widget配置数据结构，存储Widget的所有配置信息

#### 🎯 设计目的
WidgetConfig是Widget配置的数据载体，包含Widget的基本信息、位置大小、自定义配置等，支持JSON序列化和反序列化。

#### 📊 结构成员

**公有属性**:
```cpp
QString id;                     // Widget唯一标识符
WidgetType type;               // Widget类型
QString name;                  // Widget名称
QPoint position;               // Widget位置
QSize size;                    // Widget大小
QVariantMap customConfig;      // 自定义配置项
bool isVisible;                // 是否可见
bool isEnabled;                // 是否启用
```

**公有方法**:
```cpp
WidgetConfig();                                    // 默认构造函数
WidgetConfig(WidgetType type, const QString& name); // 带参构造函数
QJsonObject toJson() const;                        // 转换为JSON
bool fromJson(const QJsonObject& json);            // 从JSON加载
```

#### 🔧 使用示例
```cpp
// 创建配置
WidgetConfig config(WidgetType::Clock, "桌面时钟");
config.position = QPoint(100, 100);
config.size = QSize(200, 100);
config.customConfig["format"] = "hh:mm:ss";
config.customConfig["showDate"] = true;

// 序列化为JSON
QJsonObject json = config.toJson();

// 从JSON反序列化
WidgetConfig newConfig;
newConfig.fromJson(json);
```

---

### WidgetType

**类别**: 枚举类型  
**作用**: 定义系统支持的Widget类型

#### 🎯 设计目的
WidgetType枚举定义了系统支持的所有Widget类型，为Widget的创建、管理和配置提供类型标识。

#### 📊 枚举值

```cpp
enum class WidgetType {
    Clock,              // 时钟Widget
    Weather,            // 天气Widget
    SystemInfo,         // 系统信息Widget
    Calendar,           // 日历Widget
    Notes,              // 便签Widget
    SimpleNotes,        // 简单便签Widget
    AIRanking           // AI排行榜Widget
};
```

#### 🔧 使用示例
```cpp
// 类型判断
if (widget->getType() == WidgetType::Clock) {
    ClockWidget* clock = static_cast<ClockWidget*>(widget);
    // 处理时钟Widget特有逻辑
}

// 类型转换
QString typeString = widgetTypeToString(WidgetType::Weather);
WidgetType type = stringToWidgetType("Clock");
```

---

### LogLevel

**类别**: 枚举类型  
**作用**: 定义日志记录的级别

#### 🎯 设计目的
LogLevel枚举定义了日志系统的记录级别，用于控制日志输出的详细程度和重要性分类。

#### 📊 枚举值

```cpp
enum class LogLevel {
    DEBUG,      // 调试信息 - 最详细的日志信息
    INFO,       // 一般信息 - 程序运行的关键信息
    WARNING,    // 警告信息 - 可能的问题提示
    ERROR,      // 错误信息 - 运行时错误
    CRITICAL    // 严重错误 - 可能导致程序崩溃的错误
};
```

#### 🔧 使用示例
```cpp
// 设置日志级别
Logger::setLogLevel(LogLevel::INFO);

// 根据级别记录日志
Logger::debug("详细的调试信息");     // 只在DEBUG级别输出
Logger::info("程序启动成功");        // INFO级别及以上输出
Logger::warning("配置文件过期");     // WARNING级别及以上输出
Logger::error("网络连接失败");       // ERROR级别及以上输出
Logger::critical("内存分配失败");    // 总是输出
```

---

## 总结

本文档详细介绍了桌面小部件系统中的每个类，包括其设计目的、功能特性、接口定义和使用方法。整个系统采用分层架构设计，具有良好的扩展性和维护性。

### 💡 开发建议

1. **新增Widget类型**: 继承BaseWidget并实现必要接口
2. **扩展功能**: 在相应的管理类中添加新功能
3. **主题定制**: 通过ThemeManager系统实现个性化界面
4. **日志调试**: 充分利用Logger系统进行问题诊断

### 📖 相关文档

- [系统架构设计文档](技术说明文档.md)
- [UML类图](desktop_widget_system_uml.puml)
- [类关系分析报告](类关系分析报告.md)
- [使用说明文档](UML图生成使用说明.md) 